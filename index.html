<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gym Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        body { font-family: sans-serif; background: #f0f2f5; padding: 20px; text-align: center; color: #333; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        
        /* Checklist Styling */
        .checklist { text-align: left; margin: 15px 0; background: #fafafa; padding: 10px; border-radius: 8px; border: 1px solid #ddd; }
        .check-item { display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee; font-size: 17px; cursor: pointer; }
        .check-item:last-child { border-bottom: none; }
        input[type="checkbox"] { width: 22px; height: 22px; margin-right: 12px; cursor: pointer; }

        button { width: 100%; padding: 15px; margin: 10px 0; border-radius: 8px; border: none; font-size: 16px; font-weight: bold; cursor: pointer; }
        .btn-log { background: #28a745; color: white; }
        .btn-pdf { background: #007bff; color: white; margin-top: 20px; }
        
        .stats { margin-top: 20px; font-size: 1.1em; font-weight: bold; }
        .log { margin-top: 20px; text-align: left; font-size: 0.9em; max-height: 200px; overflow-y: auto; border-top: 1px solid #eee; padding-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <h2>ðŸ’ª Gym Log</h2>
    <p>Select what you trained:</p>
    
    <div class="checklist" id="muscleList">
        <label class="check-item"><input type="checkbox" value="Chest (Bench)"> Chest (Bench)</label>
        <label class="check-item"><input type="checkbox" value="Chest (Dumbbells)"> Chest (Dumbbells)</label>
        <label class="check-item"><input type="checkbox" value="Back (Chins/Rows)"> Back (Chins/Rows)</label>
        <label class="check-item"><input type="checkbox" value="Biceps"> Biceps</label>
        <label class="check-item"><input type="checkbox" value="Triceps"> Triceps</label>
        <label class="check-item"><input type="checkbox" value="Legs"> Legs</label>
        <label class="check-item"><input type="checkbox" value="Core (Situps)"> Core (Situps)</label>
    </div>

    <button class="btn-log" onclick="logWorkout()">Finish Workout!</button>

    <div class="stats">
        Workouts this week: <span id="weekCount">0</span>
    </div>

    <div class="log" id="history">
        <strong>Recent Sessions:</strong><br>
    </div>

    <button class="btn-pdf" onclick="downloadPDF()">ðŸ“© Save History as PDF</button>
</div>

<script>
    function logWorkout() {
        // Find all checked boxes
        const checkboxes = document.querySelectorAll('#muscleList input[type="checkbox"]:checked');
        
        if (checkboxes.length === 0) {
            alert("Please select at least one muscle group!");
            return;
        }

        // Combine selected values into one string (e.g., "Back, Biceps")
        const selectedMuscles = Array.from(checkboxes).map(cb => cb.value).join(", ");
        
        const now = new Date();
        const entry = { date: now.toISOString(), type: selectedMuscles };

        let history = JSON.parse(localStorage.getItem('gymLogs')) || [];
        history.push(entry);
        localStorage.setItem('gymLogs', JSON.stringify(history));

        // Clear checkboxes for next time
        checkboxes.forEach(cb => cb.checked = false);

        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        updateDisplay();
    }

    function updateDisplay() {
        const history = JSON.parse(localStorage.getItem('gymLogs')) || [];
        const historyDiv = document.getElementById('history');
        const weekSpan = document.getElementById('weekCount');

        const now = new Date();
        const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        const weeklyCount = history.filter(item => new Date(item.date) > oneWeekAgo).length;
        
        weekSpan.innerText = weeklyCount;

        historyDiv.innerHTML = "<strong>Recent Sessions:</strong><br>" + 
            history.slice(-5).reverse().map(item => {
                const d = new Date(item.date);
                return `â€¢ ${d.toLocaleDateString()}: ${item.type}`;
            }).join('<br>');
    }

    async function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const history = JSON.parse(localStorage.getItem('gymLogs')) || [];

        doc.setFontSize(20);
        doc.text("My 2026 Workout Report", 20, 20);
        doc.setFontSize(12);
        doc.text(`Total Sessions: ${history.length}`, 20, 30);
        doc.text("---------------------------------------", 20, 35);

        let yPosition = 45;
        // Make sure to copy history before reversing so we don't mess up the main UI
        [...history].reverse().forEach((item, index) => {
            if (yPosition > 280) { doc.addPage(); yPosition = 20; }
            const d = new Date(item.date);
            doc.text(`${d.toLocaleDateString()} - ${item.type}`, 20, yPosition);
            yPosition += 10;
        });

        doc.save("gym-history.pdf");
    }

    updateDisplay();
</script>

</body>
</html>
